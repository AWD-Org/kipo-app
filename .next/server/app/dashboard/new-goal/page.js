(()=>{var e={};e.id=319,e.ids=[319],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},63477:e=>{"use strict";e.exports=require("querystring")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},25409:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>m,originalPathname:()=>u,pages:()=>d,routeModule:()=>p,tree:()=>c});var a=r(50482),s=r(69108),o=r(62563),n=r.n(o),i=r(68300),l={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>i[e]);r.d(t,l);let c=["",{children:["dashboard",{children:["new-goal",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,59460)),"/Users/salomon/Documents/Projects/kipo-app/src/app/dashboard/new-goal/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,7784)),"/Users/salomon/Documents/Projects/kipo-app/src/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(r.bind(r,56281)),"/Users/salomon/Documents/Projects/kipo-app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,69361,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/salomon/Documents/Projects/kipo-app/src/app/dashboard/new-goal/page.tsx"],u="/dashboard/new-goal/page",m={require:r,loadChunk:()=>Promise.resolve()},p=new a.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/dashboard/new-goal/page",pathname:"/dashboard/new-goal",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},87276:(e,t,r)=>{let a={"57a426485a6b06027db8441044f1594d3c086f2b":()=>Promise.resolve().then(r.bind(r,99373)).then(e=>e.createGoalDirect),fa7c494de1d4863ac83ab020f061dc4df0b3dc98:()=>Promise.resolve().then(r.bind(r,99373)).then(e=>e.createGoal)};async function s(e,...t){return(await a[e]()).apply(null,t)}e.exports={"57a426485a6b06027db8441044f1594d3c086f2b":s.bind(null,"57a426485a6b06027db8441044f1594d3c086f2b"),fa7c494de1d4863ac83ab020f061dc4df0b3dc98:s.bind(null,"fa7c494de1d4863ac83ab020f061dc4df0b3dc98")}},24877:(e,t,r)=>{Promise.resolve().then(r.bind(r,14769)),Promise.resolve().then(r.bind(r,54141))},14769:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>h});var a=r(95344),s=r(3729),o=r(22254),n=r(5094),i=r(46540),l=r(63024),c=r(55794),d=r(42739);r(13664);var u=r(28371);(0,u.$)("57a426485a6b06027db8441044f1594d3c086f2b");var m=(0,u.$)("fa7c494de1d4863ac83ab020f061dc4df0b3dc98"),p=r(47674),f=r(11453);let g=["ahorro","inversi\xf3n","deuda","compra","otro"],x=["baja","media","alta"],b=[{value:"none",label:"Sin recordatorios"},{value:"daily",label:"Diario"},{value:"weekly",label:"Semanal"},{value:"monthly",label:"Mensual"}];function h(){let e=(0,o.useRouter)(),{data:t}=(0,p.useSession)(),[r,u]=(0,s.useState)(!1),[h,v]=(0,s.useState)(""),[y,j]=(0,s.useState)(!1),[N,w]=(0,s.useState)({title:"",description:"",targetAmount:"",currentAmount:"0",startDate:new Date().toISOString().split("T")[0],targetDate:"",category:"ahorro",priority:"media",reminderFrequency:"none"}),D=e=>{let{name:t,value:r}=e.target;w({...N,[t]:r})},A=async r=>{r.preventDefault();try{if(u(!0),v(""),j(!1),!t?.user?.id){v("Debes iniciar sesi\xf3n para realizar esta acci\xf3n");return}if(!N.title.trim()){v("El t\xedtulo de la meta es requerido");return}if(!N.targetAmount||0>=parseFloat(N.targetAmount)){v("El monto objetivo debe ser mayor a cero");return}if(0>parseFloat(N.currentAmount)){v("El monto actual no puede ser negativo");return}if(!N.targetDate){v("La fecha objetivo es requerida");return}let r=new Date;if(new Date(N.targetDate)<=r){v("La fecha objetivo debe ser en el futuro");return}let a=new FormData;Object.entries(N).forEach(([e,t])=>{a.append(e,t.toString())});let s=await m(t.user.id,a);if(!s.success){if(s.validationErrors){let e=Object.values(s.validationErrors).flat();v(e.join(", "))}else v(s.error||"Error al crear la meta");return}j(!0),window.confirm("Meta creada con \xe9xito. \xbfDeseas crear otra?")?w({title:"",description:"",targetAmount:"",currentAmount:"0",startDate:new Date().toISOString().split("T")[0],targetDate:"",category:"ahorro",priority:"media",reminderFrequency:"none"}):e.push("/dashboard")}catch(e){console.error("Error en createGoal:",e),v("Error al procesar la meta")}finally{u(!1)}},q=(0,f.SB)(parseFloat(N.currentAmount)||0,parseFloat(N.targetAmount)||1);return a.jsx("div",{className:"kipo-form-container",children:(0,a.jsxs)("form",{onSubmit:A,className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(n.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>e.back(),className:"gap-1",children:[a.jsx(l.Z,{size:16})," Volver"]}),a.jsx("h1",{className:"text-2xl font-bold",children:"Nueva meta financiera"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"title",className:"text-sm font-medium",children:"T\xedtulo de la meta"}),a.jsx(i.I,{id:"title",name:"title",placeholder:"Ej. Fondo de emergencia, Vacaciones, etc.",value:N.title,onChange:D,required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"description",className:"text-sm font-medium",children:"Descripci\xf3n (opcional)"}),a.jsx("textarea",{id:"description",name:"description",placeholder:"Descripci\xf3n detallada de tu meta",value:N.description,onChange:D,className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"targetAmount",className:"text-sm font-medium",children:"Monto objetivo"}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),a.jsx(i.I,{id:"targetAmount",name:"targetAmount",type:"number",placeholder:"0.00",value:N.targetAmount,onChange:D,className:"pl-8",step:"0.01",min:"0",required:!0})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"currentAmount",className:"text-sm font-medium",children:"Monto actual (si ya tienes ahorrado algo)"}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),a.jsx(i.I,{id:"currentAmount",name:"currentAmount",type:"number",placeholder:"0.00",value:N.currentAmount,onChange:D,className:"pl-8",step:"0.01",min:"0"})]})]}),N.targetAmount&&parseFloat(N.targetAmount)>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[a.jsx("span",{children:"Progreso actual"}),(0,a.jsxs)("span",{children:[Math.round(q),"%"]})]}),a.jsx("div",{className:"w-full bg-secondary rounded-full h-2.5",children:a.jsx("div",{className:"bg-primary h-2.5 rounded-full",style:{width:`${q}%`}})}),(0,a.jsxs)("div",{className:"flex justify-between text-sm text-muted-foreground",children:[a.jsx("span",{children:(0,f.xG)(parseFloat(N.currentAmount)||0)}),a.jsx("span",{children:(0,f.xG)(parseFloat(N.targetAmount)||0)})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"startDate",className:"text-sm font-medium",children:"Fecha de inicio"}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx(c.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a.jsx(i.I,{id:"startDate",name:"startDate",type:"date",value:N.startDate,onChange:D,className:"pl-10",required:!0})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"targetDate",className:"text-sm font-medium",children:"Fecha objetivo"}),(0,a.jsxs)("div",{className:"relative",children:[a.jsx(c.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),a.jsx(i.I,{id:"targetDate",name:"targetDate",type:"date",value:N.targetDate,onChange:D,className:"pl-10",required:!0})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"category",className:"text-sm font-medium",children:"Categor\xeda"}),a.jsx("select",{id:"category",name:"category",value:N.category,onChange:D,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",required:!0,children:g.map(e=>a.jsx("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"priority",className:"text-sm font-medium",children:"Prioridad"}),a.jsx("select",{id:"priority",name:"priority",value:N.priority,onChange:D,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",required:!0,children:x.map(e=>a.jsx("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[a.jsx("label",{htmlFor:"reminderFrequency",className:"text-sm font-medium",children:"Recordatorios"}),a.jsx("select",{id:"reminderFrequency",name:"reminderFrequency",value:N.reminderFrequency,onChange:D,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:b.map(e=>a.jsx("option",{value:e.value,children:e.label},e.value))}),a.jsx("p",{className:"text-xs text-muted-foreground",children:"Recibir\xe1s recordatorios para contribuir a esta meta seg\xfan la frecuencia seleccionada."})]}),h&&a.jsx("div",{className:"rounded-md bg-destructive/15 p-3 text-sm text-destructive",children:h}),y&&a.jsx("div",{className:"rounded-md bg-green-100 p-3 text-sm text-green-800",children:"Meta creada con \xe9xito."}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[a.jsx(n.z,{type:"button",variant:"outline",onClick:()=>e.back(),children:"Cancelar"}),a.jsx(n.z,{type:"submit",disabled:r,children:r?(0,a.jsxs)(a.Fragment,{children:[a.jsx(d.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Guardando..."]}):"Guardar meta"})]})]})})}},46540:(e,t,r)=>{"use strict";r.d(t,{I:()=>n});var a=r(95344),s=r(3729),o=r(11453);let n=s.forwardRef(({className:e,type:t,...r},s)=>a.jsx("input",{type:t,className:(0,o.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:s,...r}));n.displayName="Input"},99373:(e,t,r)=>{"use strict";r.r(t),r.d(t,{createGoal:()=>l,createGoalDirect:()=>c});var a=r(98601);r(75811);var s=r(86412),o=r(43811),n=r(46893);let i=s.z.object({title:s.z.string().min(1,{message:"El t\xedtulo es requerido"}),description:s.z.string().optional(),targetAmount:s.z.number().positive({message:"El monto objetivo debe ser positivo"}),currentAmount:s.z.number().nonnegative({message:"El monto actual no puede ser negativo"}).optional().default(0),startDate:s.z.string().transform(e=>new Date(e)).optional().default(()=>new Date().toISOString()),targetDate:s.z.string().transform(e=>new Date(e)),category:s.z.enum(["ahorro","inversi\xf3n","deuda","compra","otro"]).default("ahorro"),priority:s.z.enum(["baja","media","alta"]).default("media"),reminderFrequency:s.z.enum(["none","daily","weekly","monthly"]).default("none")});async function l(e,t){try{let r={title:t.get("title"),description:t.get("description"),targetAmount:parseFloat(t.get("targetAmount")),currentAmount:t.get("currentAmount")?parseFloat(t.get("currentAmount")):0,startDate:t.get("startDate")||new Date().toISOString(),targetDate:t.get("targetDate"),category:t.get("category"),priority:t.get("priority"),reminderFrequency:t.get("reminderFrequency")},a=i.parse(r),s=await fetch("/api/goals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:e,...a,isCompleted:a.currentAmount>=a.targetAmount,isActive:!0})});if(!s.ok){let e=await s.json();return{success:!1,error:e.message||"Error creando meta"}}return(0,o.revalidatePath)("/dashboard"),{success:!0,data:a}}catch(e){if(console.error("Error en createGoal:",e),e instanceof s.z.ZodError)return{success:!1,validationErrors:e.flatten().fieldErrors};return{success:!1,error:"Error al procesar la meta"}}}async function c(e,t){try{let r=i.parse(t),a=await fetch("/api/goals",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:e,...r,isCompleted:r.currentAmount>=r.targetAmount,isActive:!0})});if(!a.ok){let e=await a.json();return{success:!1,error:e.message||"Error creando meta"}}return(0,o.revalidatePath)("/dashboard"),{success:!0,data:r}}catch(e){if(console.error("Error en createGoalDirect:",e),e instanceof s.z.ZodError)return{success:!1,validationErrors:e.flatten().fieldErrors};return{success:!1,error:"Error al procesar la meta"}}}(0,n.ensureServerEntryExports)([l,c]),(0,a.createActionProxy)("fa7c494de1d4863ac83ab020f061dc4df0b3dc98",l),(0,a.createActionProxy)("57a426485a6b06027db8441044f1594d3c086f2b",c)},59460:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>c});var a=r(25036);let s=(0,r(86843).createProxy)(String.raw`/Users/salomon/Documents/Projects/kipo-app/src/components/GoalsForm.tsx`),{__esModule:o,$$typeof:n}=s,i=s.default;var l=r(79316);function c(){return a.jsx(l.m$,{children:a.jsx(i,{})})}},79316:(e,t,r)=>{"use strict";r.d(t,{m$:()=>i});var a=r(86843);let s=(0,a.createProxy)(String.raw`/Users/salomon/Documents/Projects/kipo-app/src/store/index.tsx`),{__esModule:o,$$typeof:n}=s;s.default,(0,a.createProxy)(String.raw`/Users/salomon/Documents/Projects/kipo-app/src/store/index.tsx#store`);let i=(0,a.createProxy)(String.raw`/Users/salomon/Documents/Projects/kipo-app/src/store/index.tsx#ReduxProvider`)}};var t=require("../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[638,367,969,393,476,255,596,420,453],()=>r(25409));module.exports=a})();