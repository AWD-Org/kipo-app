(()=>{var e={};e.id=479,e.ids=[479],e.modules={11185:e=>{"use strict";e.exports=require("mongoose")},47849:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external")},72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},55403:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},94749:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},39491:e=>{"use strict";e.exports=require("assert")},14300:e=>{"use strict";e.exports=require("buffer")},6113:e=>{"use strict";e.exports=require("crypto")},82361:e=>{"use strict";e.exports=require("events")},13685:e=>{"use strict";e.exports=require("http")},95687:e=>{"use strict";e.exports=require("https")},63477:e=>{"use strict";e.exports=require("querystring")},57310:e=>{"use strict";e.exports=require("url")},73837:e=>{"use strict";e.exports=require("util")},59796:e=>{"use strict";e.exports=require("zlib")},45104:(e,r,t)=>{"use strict";t.r(r),t.d(r,{GlobalError:()=>o.a,__next_app__:()=>p,originalPathname:()=>u,pages:()=>d,routeModule:()=>m,tree:()=>l});var s=t(50482),a=t(69108),n=t(62563),o=t.n(n),i=t(68300),c={};for(let e in i)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>i[e]);t.d(r,c);let l=["",{children:["dashboard",{children:["new-transaction",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,65814)),"/Users/salomon/Documents/Projects/kipo-app/src/app/dashboard/new-transaction/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(t.bind(t,7784)),"/Users/salomon/Documents/Projects/kipo-app/src/app/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,56281)),"/Users/salomon/Documents/Projects/kipo-app/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,69361,23)),"next/dist/client/components/not-found-error"]}],d=["/Users/salomon/Documents/Projects/kipo-app/src/app/dashboard/new-transaction/page.tsx"],u="/dashboard/new-transaction/page",p={require:t,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.x.APP_PAGE,page:"/dashboard/new-transaction/page",pathname:"/dashboard/new-transaction",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:l}})},51080:(e,r,t)=>{let s={"5267d4393e59df6dc3ad8be98008f0631733a9a6":()=>Promise.resolve().then(t.bind(t,85556)).then(e=>e.createTransaction),c759ed0c79d3b85be14fbe3e0e30762d25816ddf:()=>Promise.resolve().then(t.bind(t,85556)).then(e=>e.createTransactionDirect)};async function a(e,...r){return(await s[e]()).apply(null,r)}e.exports={"5267d4393e59df6dc3ad8be98008f0631733a9a6":a.bind(null,"5267d4393e59df6dc3ad8be98008f0631733a9a6"),c759ed0c79d3b85be14fbe3e0e30762d25816ddf:a.bind(null,"c759ed0c79d3b85be14fbe3e0e30762d25816ddf")}},51695:(e,r,t)=>{Promise.resolve().then(t.bind(t,32047)),Promise.resolve().then(t.bind(t,54141))},32047:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>b});var s=t(95344),a=t(3729),n=t(22254),o=t(5094),i=t(46540),c=t(63024),l=t(55794);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,t(69224).Z)("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);var u=t(42739);t(13664);var p=t(28371);(0,p.$)("c759ed0c79d3b85be14fbe3e0e30762d25816ddf");var m=(0,p.$)("5267d4393e59df6dc3ad8be98008f0631733a9a6"),x=t(47674);let g=["Vivienda","Alimentaci\xf3n","Transporte","Servicios","Entretenimiento","Salud","Educaci\xf3n","Ropa","Personal","Mascotas","Deudas","Otros"],f=["Salario","Freelance","Inversiones","Venta","Regalo","Reembolso","Otros"];function b(){let e=(0,n.useRouter)(),{data:r}=(0,x.useSession)(),[t,p]=(0,a.useState)(!1),[b,h]=(0,a.useState)(""),[y,v]=(0,a.useState)(!1),[j,N]=(0,a.useState)({type:"gasto",amount:"",category:"",description:"",date:new Date().toISOString().split("T")[0],isRecurrent:!1,recurrenceFrequency:"none",tags:[]}),[k,w]=(0,a.useState)(""),q=e=>{let{name:r,value:t,type:s}=e.target;if("checkbox"===s){let t=e.target;N({...j,[r]:t.checked})}else N({...j,[r]:t})},P=e=>{N({...j,tags:j.tags.filter(r=>r!==e)})},E=async t=>{t.preventDefault();try{if(p(!0),h(""),v(!1),!r?.user?.id){h("Debes iniciar sesi\xf3n para realizar esta acci\xf3n");return}if(!j.amount||0>=parseFloat(j.amount)){h("El monto debe ser mayor a cero");return}if(!j.category){h("Debes seleccionar una categor\xeda");return}let t=new FormData;t.append("type",j.type),t.append("amount",j.amount),t.append("category",j.category),t.append("description",j.description),t.append("date",j.date),t.append("isRecurrent",j.isRecurrent?"on":"off"),t.append("recurrenceFrequency",j.recurrenceFrequency),j.tags.forEach(e=>{t.append("tags",e)});let s=await m(r.user.id,t);if(!s.success){if(s.validationErrors){let e=Object.values(s.validationErrors).flat();h(e.join(", "))}else h(s.error||"Error al crear la transacci\xf3n");return}v(!0),window.confirm("Transacci\xf3n creada con \xe9xito. \xbfDeseas crear otra?")?N({type:"gasto",amount:"",category:"",description:"",date:new Date().toISOString().split("T")[0],isRecurrent:!1,recurrenceFrequency:"none",tags:[]}):e.push("/dashboard")}catch(e){console.error("Error en createTransaction:",e),h("Error al procesar la transacci\xf3n")}finally{p(!1)}},S="ingreso"===j.type?f:g;return s.jsx("div",{className:"kipo-form-container",children:(0,s.jsxs)("form",{onSubmit:E,className:"space-y-8",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center",children:[(0,s.jsxs)(o.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>e.back(),className:"gap-1",children:[s.jsx(c.Z,{size:16})," Volver"]}),s.jsx("h1",{className:"text-2xl font-bold",children:"Nueva transacci\xf3n"})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[s.jsx("label",{className:"text-sm font-medium block",children:"Tipo de transacci\xf3n"}),(0,s.jsxs)("div",{className:"flex gap-4",children:[(0,s.jsxs)("label",{className:`flex-1 flex items-center justify-center gap-2 rounded-md border p-3 cursor-pointer ${"ingreso"===j.type?"bg-green-50 border-green-500 text-green-700":"bg-background hover:bg-muted/50"}`,children:[s.jsx("input",{type:"radio",name:"type",value:"ingreso",checked:"ingreso"===j.type,onChange:q,className:"sr-only"}),s.jsx("span",{children:"Ingreso"})]}),(0,s.jsxs)("label",{className:`flex-1 flex items-center justify-center gap-2 rounded-md border p-3 cursor-pointer ${"gasto"===j.type?"bg-red-50 border-red-500 text-red-700":"bg-background hover:bg-muted/50"}`,children:[s.jsx("input",{type:"radio",name:"type",value:"gasto",checked:"gasto"===j.type,onChange:q,className:"sr-only"}),s.jsx("span",{children:"Gasto"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"amount",className:"text-sm font-medium",children:"Monto"}),(0,s.jsxs)("div",{className:"relative",children:[s.jsx("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),s.jsx(i.I,{id:"amount",name:"amount",type:"number",placeholder:"0.00",value:j.amount,onChange:q,className:"pl-8",step:"0.01",min:"0",required:!0})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"category",className:"text-sm font-medium",children:"Categor\xeda"}),(0,s.jsxs)("select",{id:"category",name:"category",value:j.category,onChange:q,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",required:!0,children:[s.jsx("option",{value:"",children:"Selecciona una categor\xeda"}),S.map(e=>s.jsx("option",{value:e,children:e},e))]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"description",className:"text-sm font-medium",children:"Descripci\xf3n (opcional)"}),s.jsx("textarea",{id:"description",name:"description",placeholder:"Descripci\xf3n de la transacci\xf3n",value:j.description,onChange:q,className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx("label",{htmlFor:"date",className:"text-sm font-medium",children:"Fecha"}),(0,s.jsxs)("div",{className:"relative",children:[s.jsx(l.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),s.jsx(i.I,{id:"date",name:"date",type:"date",value:j.date,onChange:q,className:"pl-10",required:!0})]})]}),(0,s.jsxs)("div",{className:"space-y-4",children:[(0,s.jsxs)("div",{className:"flex items-center",children:[s.jsx("input",{id:"isRecurrent",name:"isRecurrent",type:"checkbox",checked:j.isRecurrent,onChange:q,className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),s.jsx("label",{htmlFor:"isRecurrent",className:"ml-2 text-sm font-medium",children:"Es una transacci\xf3n recurrente"})]}),j.isRecurrent&&(0,s.jsxs)("div",{className:"ml-6",children:[s.jsx("label",{htmlFor:"recurrenceFrequency",className:"text-sm font-medium",children:"Frecuencia"}),(0,s.jsxs)("select",{id:"recurrenceFrequency",name:"recurrenceFrequency",value:j.recurrenceFrequency,onChange:q,className:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[s.jsx("option",{value:"none",children:"Selecciona una frecuencia"}),s.jsx("option",{value:"daily",children:"Diaria"}),s.jsx("option",{value:"weekly",children:"Semanal"}),s.jsx("option",{value:"monthly",children:"Mensual"}),s.jsx("option",{value:"yearly",children:"Anual"})]})]})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[s.jsx("label",{className:"text-sm font-medium",children:"Etiquetas (opcional)"}),(0,s.jsxs)("div",{className:"flex items-center",children:[(0,s.jsxs)("div",{className:"relative flex-1",children:[s.jsx(d,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),s.jsx(i.I,{value:k,onChange:e=>w(e.target.value),placeholder:"A\xf1adir etiqueta",className:"pl-10"})]}),s.jsx(o.z,{type:"button",variant:"outline",className:"ml-2",onClick:()=>{k&&!j.tags.includes(k)&&(N({...j,tags:[...j.tags,k]}),w(""))},disabled:!k,children:"A\xf1adir"})]}),j.tags.length>0&&s.jsx("div",{className:"flex flex-wrap gap-2 mt-2",children:j.tags.map((e,r)=>(0,s.jsxs)("div",{className:"flex items-center bg-secondary text-secondary-foreground rounded-full px-3 py-1 text-sm",children:[s.jsx("span",{children:e}),s.jsx("button",{type:"button",onClick:()=>P(e),className:"ml-2 h-4 w-4 rounded-full flex items-center justify-center hover:bg-background/80",children:"\xd7"})]},r))})]}),b&&s.jsx("div",{className:"rounded-md bg-destructive/15 p-3 text-sm text-destructive",children:b}),y&&s.jsx("div",{className:"rounded-md bg-green-100 p-3 text-sm text-green-800",children:"Transacci\xf3n creada con \xe9xito."}),(0,s.jsxs)("div",{className:"flex justify-end gap-2",children:[s.jsx(o.z,{type:"button",variant:"outline",onClick:()=>e.back(),children:"Cancelar"}),s.jsx(o.z,{type:"submit",disabled:t,children:t?(0,s.jsxs)(s.Fragment,{children:[s.jsx(u.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Guardando..."]}):"Guardar transacci\xf3n"})]})]})})}},46540:(e,r,t)=>{"use strict";t.d(r,{I:()=>o});var s=t(95344),a=t(3729),n=t(11453);let o=a.forwardRef(({className:e,type:r,...t},a)=>s.jsx("input",{type:r,className:(0,n.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",e),ref:a,...t}));o.displayName="Input"},85556:(e,r,t)=>{"use strict";t.r(r),t.d(r,{createTransaction:()=>c,createTransactionDirect:()=>l});var s=t(98601);t(75811);var a=t(86412),n=t(43811),o=t(46893);let i=a.z.object({type:a.z.enum(["ingreso","gasto"]),amount:a.z.number().positive({message:"El monto debe ser positivo"}),category:a.z.string().min(1,{message:"La categor\xeda es requerida"}),description:a.z.string().optional(),date:a.z.string().transform(e=>new Date(e)),isRecurrent:a.z.boolean().optional().default(!1),recurrenceFrequency:a.z.enum(["none","daily","weekly","monthly","yearly"]).optional().default("none"),tags:a.z.array(a.z.string()).optional().default([])});async function c(e,r){try{let t={type:r.get("type"),amount:parseFloat(r.get("amount")),category:r.get("category"),description:r.get("description"),date:r.get("date"),isRecurrent:"on"===r.get("isRecurrent"),recurrenceFrequency:r.get("recurrenceFrequency"),tags:r.getAll("tags").map(e=>e.toString())},s=i.parse(t),a=await fetch("/api/transactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:e,...s})});if(!a.ok){let e=await a.json();return{success:!1,error:e.message||"Error creando transacci\xf3n"}}return(0,n.revalidatePath)("/dashboard"),{success:!0,data:s}}catch(e){if(console.error("Error en createTransaction:",e),e instanceof a.z.ZodError)return{success:!1,validationErrors:e.flatten().fieldErrors};return{success:!1,error:"Error al procesar la transacci\xf3n"}}}async function l(e,r){try{let t=i.parse(r),s=await fetch("/api/transactions",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user:e,...t})});if(!s.ok){let e=await s.json();return{success:!1,error:e.message||"Error creando transacci\xf3n"}}return(0,n.revalidatePath)("/dashboard"),{success:!0,data:t}}catch(e){if(console.error("Error en createTransactionDirect:",e),e instanceof a.z.ZodError)return{success:!1,validationErrors:e.flatten().fieldErrors};return{success:!1,error:"Error al procesar la transacci\xf3n"}}}(0,o.ensureServerEntryExports)([c,l]),(0,s.createActionProxy)("5267d4393e59df6dc3ad8be98008f0631733a9a6",c),(0,s.createActionProxy)("c759ed0c79d3b85be14fbe3e0e30762d25816ddf",l)},65814:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>l});var s=t(25036);let a=(0,t(86843).createProxy)(String.raw`/Users/salomon/Documents/Projects/kipo-app/src/components/TxForm.tsx`),{__esModule:n,$$typeof:o}=a,i=a.default;var c=t(79316);function l(){return s.jsx(c.m$,{children:s.jsx(i,{})})}},79316:(e,r,t)=>{"use strict";t.d(r,{m$:()=>i});var s=t(86843);let a=(0,s.createProxy)(String.raw`/Users/salomon/Documents/Projects/kipo-app/src/store/index.tsx`),{__esModule:n,$$typeof:o}=a;a.default,(0,s.createProxy)(String.raw`/Users/salomon/Documents/Projects/kipo-app/src/store/index.tsx#store`);let i=(0,s.createProxy)(String.raw`/Users/salomon/Documents/Projects/kipo-app/src/store/index.tsx#ReduxProvider`)}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[638,367,969,393,476,255,596,420,453],()=>t(45104));module.exports=s})();