(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[479],{73067:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,a(62898).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},28203:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,a(62898).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},86264:function(e,r,a){"use strict";a.d(r,{Z:function(){return t}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let t=(0,a(62898).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},27338:function(e,r,a){Promise.resolve().then(a.bind(a,17729)),Promise.resolve().then(a.bind(a,72358))},17729:function(e,r,a){"use strict";a.r(r),a.d(r,{default:function(){return b}});var t=a(57437),n=a(2265),s=a(24033),i=a(575),l=a(22782),c=a(73067),o=a(28203);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let d=(0,a(62898).Z)("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);var u=a(86264);a(15355);var m=a(31162);(0,m.$)("c759ed0c79d3b85be14fbe3e0e30762d25816ddf");var p=(0,m.$)("5267d4393e59df6dc3ad8be98008f0631733a9a6"),f=a(82749);let x=["Vivienda","Alimentaci\xf3n","Transporte","Servicios","Entretenimiento","Salud","Educaci\xf3n","Ropa","Personal","Mascotas","Deudas","Otros"],g=["Salario","Freelance","Inversiones","Venta","Regalo","Reembolso","Otros"];function b(){let e=(0,s.useRouter)(),{data:r}=(0,f.useSession)(),[a,m]=(0,n.useState)(!1),[b,h]=(0,n.useState)(""),[y,v]=(0,n.useState)(!1),[j,N]=(0,n.useState)({type:"gasto",amount:"",category:"",description:"",date:new Date().toISOString().split("T")[0],isRecurrent:!1,recurrenceFrequency:"none",tags:[]}),[k,w]=(0,n.useState)(""),F=e=>{let{name:r,value:a,type:t}=e.target;if("checkbox"===t){let a=e.target;N({...j,[r]:a.checked})}else N({...j,[r]:a})},S=e=>{N({...j,tags:j.tags.filter(r=>r!==e)})},C=async a=>{a.preventDefault();try{var t;if(m(!0),h(""),v(!1),!(null==r?void 0:null===(t=r.user)||void 0===t?void 0:t.id)){h("Debes iniciar sesi\xf3n para realizar esta acci\xf3n");return}if(!j.amount||0>=parseFloat(j.amount)){h("El monto debe ser mayor a cero");return}if(!j.category){h("Debes seleccionar una categor\xeda");return}let a=new FormData;a.append("type",j.type),a.append("amount",j.amount),a.append("category",j.category),a.append("description",j.description),a.append("date",j.date),a.append("isRecurrent",j.isRecurrent?"on":"off"),a.append("recurrenceFrequency",j.recurrenceFrequency),j.tags.forEach(e=>{a.append("tags",e)});let n=await p(r.user.id,a);if(!n.success){if(n.validationErrors){let e=Object.values(n.validationErrors).flat();h(e.join(", "))}else h(n.error||"Error al crear la transacci\xf3n");return}v(!0),window.confirm("Transacci\xf3n creada con \xe9xito. \xbfDeseas crear otra?")?N({type:"gasto",amount:"",category:"",description:"",date:new Date().toISOString().split("T")[0],isRecurrent:!1,recurrenceFrequency:"none",tags:[]}):e.push("/dashboard")}catch(e){console.error("Error en createTransaction:",e),h("Error al procesar la transacci\xf3n")}finally{m(!1)}},R="ingreso"===j.type?g:x;return(0,t.jsx)("div",{className:"kipo-form-container",children:(0,t.jsxs)("form",{onSubmit:C,className:"space-y-8",children:[(0,t.jsxs)("div",{className:"flex justify-between items-center",children:[(0,t.jsxs)(i.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>e.back(),className:"gap-1",children:[(0,t.jsx)(c.Z,{size:16})," Volver"]}),(0,t.jsx)("h1",{className:"text-2xl font-bold",children:"Nueva transacci\xf3n"})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsx)("label",{className:"text-sm font-medium block",children:"Tipo de transacci\xf3n"}),(0,t.jsxs)("div",{className:"flex gap-4",children:[(0,t.jsxs)("label",{className:"flex-1 flex items-center justify-center gap-2 rounded-md border p-3 cursor-pointer ".concat("ingreso"===j.type?"bg-green-50 border-green-500 text-green-700":"bg-background hover:bg-muted/50"),children:[(0,t.jsx)("input",{type:"radio",name:"type",value:"ingreso",checked:"ingreso"===j.type,onChange:F,className:"sr-only"}),(0,t.jsx)("span",{children:"Ingreso"})]}),(0,t.jsxs)("label",{className:"flex-1 flex items-center justify-center gap-2 rounded-md border p-3 cursor-pointer ".concat("gasto"===j.type?"bg-red-50 border-red-500 text-red-700":"bg-background hover:bg-muted/50"),children:[(0,t.jsx)("input",{type:"radio",name:"type",value:"gasto",checked:"gasto"===j.type,onChange:F,className:"sr-only"}),(0,t.jsx)("span",{children:"Gasto"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{htmlFor:"amount",className:"text-sm font-medium",children:"Monto"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),(0,t.jsx)(l.I,{id:"amount",name:"amount",type:"number",placeholder:"0.00",value:j.amount,onChange:F,className:"pl-8",step:"0.01",min:"0",required:!0})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{htmlFor:"category",className:"text-sm font-medium",children:"Categor\xeda"}),(0,t.jsxs)("select",{id:"category",name:"category",value:j.category,onChange:F,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",required:!0,children:[(0,t.jsx)("option",{value:"",children:"Selecciona una categor\xeda"}),R.map(e=>(0,t.jsx)("option",{value:e,children:e},e))]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{htmlFor:"description",className:"text-sm font-medium",children:"Descripci\xf3n (opcional)"}),(0,t.jsx)("textarea",{id:"description",name:"description",placeholder:"Descripci\xf3n de la transacci\xf3n",value:j.description,onChange:F,className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{htmlFor:"date",className:"text-sm font-medium",children:"Fecha"}),(0,t.jsxs)("div",{className:"relative",children:[(0,t.jsx)(o.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(l.I,{id:"date",name:"date",type:"date",value:j.date,onChange:F,className:"pl-10",required:!0})]})]}),(0,t.jsxs)("div",{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsx)("input",{id:"isRecurrent",name:"isRecurrent",type:"checkbox",checked:j.isRecurrent,onChange:F,className:"h-4 w-4 rounded border-gray-300 text-primary focus:ring-primary"}),(0,t.jsx)("label",{htmlFor:"isRecurrent",className:"ml-2 text-sm font-medium",children:"Es una transacci\xf3n recurrente"})]}),j.isRecurrent&&(0,t.jsxs)("div",{className:"ml-6",children:[(0,t.jsx)("label",{htmlFor:"recurrenceFrequency",className:"text-sm font-medium",children:"Frecuencia"}),(0,t.jsxs)("select",{id:"recurrenceFrequency",name:"recurrenceFrequency",value:j.recurrenceFrequency,onChange:F,className:"mt-1 flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:[(0,t.jsx)("option",{value:"none",children:"Selecciona una frecuencia"}),(0,t.jsx)("option",{value:"daily",children:"Diaria"}),(0,t.jsx)("option",{value:"weekly",children:"Semanal"}),(0,t.jsx)("option",{value:"monthly",children:"Mensual"}),(0,t.jsx)("option",{value:"yearly",children:"Anual"})]})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[(0,t.jsx)("label",{className:"text-sm font-medium",children:"Etiquetas (opcional)"}),(0,t.jsxs)("div",{className:"flex items-center",children:[(0,t.jsxs)("div",{className:"relative flex-1",children:[(0,t.jsx)(d,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,t.jsx)(l.I,{value:k,onChange:e=>w(e.target.value),placeholder:"A\xf1adir etiqueta",className:"pl-10"})]}),(0,t.jsx)(i.z,{type:"button",variant:"outline",className:"ml-2",onClick:()=>{k&&!j.tags.includes(k)&&(N({...j,tags:[...j.tags,k]}),w(""))},disabled:!k,children:"A\xf1adir"})]}),j.tags.length>0&&(0,t.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:j.tags.map((e,r)=>(0,t.jsxs)("div",{className:"flex items-center bg-secondary text-secondary-foreground rounded-full px-3 py-1 text-sm",children:[(0,t.jsx)("span",{children:e}),(0,t.jsx)("button",{type:"button",onClick:()=>S(e),className:"ml-2 h-4 w-4 rounded-full flex items-center justify-center hover:bg-background/80",children:"\xd7"})]},r))})]}),b&&(0,t.jsx)("div",{className:"rounded-md bg-destructive/15 p-3 text-sm text-destructive",children:b}),y&&(0,t.jsx)("div",{className:"rounded-md bg-green-100 p-3 text-sm text-green-800",children:"Transacci\xf3n creada con \xe9xito."}),(0,t.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,t.jsx)(i.z,{type:"button",variant:"outline",onClick:()=>e.back(),children:"Cancelar"}),(0,t.jsx)(i.z,{type:"submit",disabled:a,children:a?(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(u.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Guardando..."]}):"Guardar transacci\xf3n"})]})]})})}},22782:function(e,r,a){"use strict";a.d(r,{I:function(){return i}});var t=a(57437),n=a(2265),s=a(22169);let i=n.forwardRef((e,r)=>{let{className:a,type:n,...i}=e;return(0,t.jsx)("input",{type:n,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",a),ref:r,...i})});i.displayName="Input"},31162:function(e,r,a){"use strict";Object.defineProperty(r,"$",{enumerable:!0,get:function(){return n}});let t=a(15355);function n(e){let{createServerReference:r}=a(6671);return r(e,t.callServer)}},24033:function(e,r,a){e.exports=a(15313)}},function(e){e.O(0,[451,873,743,317,971,938,744],function(){return e(e.s=27338)}),_N_E=e.O()}]);