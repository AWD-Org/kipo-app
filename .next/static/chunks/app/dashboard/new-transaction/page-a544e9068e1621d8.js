(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[479],{73067:function(e,a,r){"use strict";r.d(a,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(62898).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},28203:function(e,a,r){"use strict";r.d(a,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(62898).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},86264:function(e,a,r){"use strict";r.d(a,{Z:function(){return n}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let n=(0,r(62898).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},27338:function(e,a,r){Promise.resolve().then(r.bind(r,17729)),Promise.resolve().then(r.bind(r,72358))},17729:function(e,a,r){"use strict";r.r(a),r.d(a,{default:function(){return f}});var n=r(57437),t=r(2265),s=r(24033),i=r(82749),l=r(575),c=r(22782),o=r(73067),d=r(28203);/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let u=(0,r(62898).Z)("Tag",[["path",{d:"M12 2H2v10l9.29 9.29c.94.94 2.48.94 3.42 0l6.58-6.58c.94-.94.94-2.48 0-3.42L12 2Z",key:"14b2ls"}],["path",{d:"M7 7h.01",key:"7u93v4"}]]);var x=r(86264);r(15355);var m=(0,r(31162).$)("5267d4393e59df6dc3ad8be98008f0631733a9a6");let p=["Vivienda","Alimentaci\xf3n","Transporte","Servicios","Entretenimiento","Salud","Educaci\xf3n","Ropa","Personal","Mascotas","Deudas","Otros"],h=["Salario","Freelance","Inversiones","Venta","Regalo","Reembolso","Otros"];function f(){let e=(0,s.useRouter)(),{data:a,status:r}=(0,i.useSession)(),[f,g]=(0,t.useState)(!1),[y,b]=(0,t.useState)(""),[v,j]=(0,t.useState)(!1),[N,k]=(0,t.useState)(""),[w,S]=(0,t.useState)({type:"gasto",amount:"",category:"",description:"",date:new Date().toISOString().split("T")[0],isRecurrent:!1,recurrenceFrequency:"none",tags:[]}),C=e=>{let{name:a,value:r,type:n,checked:t}=e.target;S(e=>({...e,[a]:"checkbox"===n?t:r}))},F=e=>{S(a=>({...a,tags:a.tags.filter(a=>a!==e)}))},E=async a=>{if(a.preventDefault(),b(""),j(!1),"authenticated"!==r){b("Debes iniciar sesi\xf3n para crear una transacci\xf3n");return}if(!w.amount||0>=parseFloat(w.amount)){b("El monto debe ser mayor a cero");return}if(!w.category){b("Debes seleccionar una categor\xeda");return}g(!0);try{let a=new FormData;Object.entries(w).forEach(e=>{let[r,n]=e;Array.isArray(n)?n.forEach(e=>a.append(r,e)):"boolean"==typeof n?a.append(r,n?"on":"off"):a.append(r,String(n))});let r=await m(a);r.success?(j(!0),confirm("Transacci\xf3n creada con \xe9xito. \xbfQuieres agregar otra?")?S({type:"gasto",amount:"",category:"",description:"",date:new Date().toISOString().split("T")[0],isRecurrent:!1,recurrenceFrequency:"none",tags:[]}):e.push("/dashboard")):b(r.error||"Error al crear la transacci\xf3n")}catch(e){console.error(e),b("Error al procesar la transacci\xf3n")}finally{g(!1)}},R="ingreso"===w.type?h:p;return(0,n.jsx)("div",{className:"max-w-xl mx-auto p-4",children:(0,n.jsxs)("form",{onSubmit:E,className:"space-y-6",children:[(0,n.jsxs)("div",{className:"flex justify-between items-center",children:[(0,n.jsxs)(l.z,{type:"button",variant:"ghost",onClick:()=>e.back(),size:"sm",children:[(0,n.jsx)(o.Z,{size:16})," Volver"]}),(0,n.jsx)("h1",{className:"text-2xl font-bold",children:"Nueva transacci\xf3n"})]}),(0,n.jsx)("div",{className:"flex gap-4",children:["ingreso","gasto"].map(e=>(0,n.jsxs)("label",{className:"flex-1 text-center p-3 border rounded cursor-pointer ".concat(w.type===e?"ingreso"===e?"bg-green-50 border-green-500":"bg-red-50 border-red-500":"hover:bg-muted/50"),children:[(0,n.jsx)("input",{type:"radio",name:"type",value:e,checked:w.type===e,onChange:C,className:"sr-only"}),"ingreso"===e?"Ingreso":"Gasto"]},e))}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"amount",children:"Monto"}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2",children:"$"}),(0,n.jsx)(c.I,{id:"amount",name:"amount",type:"number",step:"0.01",min:"0",value:w.amount,onChange:C,className:"pl-8",required:!0})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"category",children:"Categor\xeda"}),(0,n.jsxs)("select",{id:"category",name:"category",value:w.category,onChange:C,className:"w-full border rounded p-2",required:!0,children:[(0,n.jsx)("option",{value:"",children:"Selecciona una categor\xeda"}),R.map(e=>(0,n.jsx)("option",{value:e,children:e},e))]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{htmlFor:"description",children:"Descripci\xf3n"}),(0,n.jsx)("textarea",{id:"description",name:"description",value:w.description,onChange:C,className:"w-full border rounded p-2",rows:3})]}),(0,n.jsxs)("div",{className:"relative",children:[(0,n.jsx)("label",{htmlFor:"date",children:"Fecha"}),(0,n.jsx)(d.Z,{className:"absolute left-3 top-[38px] text-muted-foreground"}),(0,n.jsx)(c.I,{id:"date",name:"date",type:"date",value:w.date,onChange:C,className:"pl-8",required:!0})]}),(0,n.jsxs)("div",{children:[(0,n.jsxs)("label",{className:"inline-flex items-center",children:[(0,n.jsx)("input",{type:"checkbox",name:"isRecurrent",checked:w.isRecurrent,onChange:C,className:"mr-2"}),"Transacci\xf3n recurrente"]}),w.isRecurrent&&(0,n.jsxs)("select",{name:"recurrenceFrequency",value:w.recurrenceFrequency,onChange:C,className:"w-full border rounded p-2 mt-2",children:[(0,n.jsx)("option",{value:"none",children:"Selecciona frecuencia"}),(0,n.jsx)("option",{value:"daily",children:"Diaria"}),(0,n.jsx)("option",{value:"weekly",children:"Semanal"}),(0,n.jsx)("option",{value:"monthly",children:"Mensual"}),(0,n.jsx)("option",{value:"yearly",children:"Anual"})]})]}),(0,n.jsxs)("div",{children:[(0,n.jsx)("label",{children:"Etiquetas"}),(0,n.jsxs)("div",{className:"flex gap-2",children:[(0,n.jsx)(u,{className:"mt-2"}),(0,n.jsx)(c.I,{value:N,onChange:e=>k(e.target.value),placeholder:"Nueva etiqueta"}),(0,n.jsx)(l.z,{type:"button",variant:"outline",onClick:()=>{N&&!w.tags.includes(N)&&(S(e=>({...e,tags:[...e.tags,N]})),k(""))},disabled:!N,children:"A\xf1adir"})]}),(0,n.jsx)("div",{className:"flex flex-wrap gap-2 mt-2",children:w.tags.map(e=>(0,n.jsxs)("span",{className:"flex items-center bg-secondary px-3 py-1 rounded-full",children:[e,(0,n.jsx)("button",{onClick:()=>F(e),className:"ml-2",children:"\xd7"})]},e))})]}),y&&(0,n.jsx)("div",{className:"text-destructive",children:y}),v&&(0,n.jsx)("div",{className:"text-green-600",children:"Transacci\xf3n creada con \xe9xito."}),(0,n.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,n.jsx)(l.z,{variant:"outline",onClick:()=>e.back(),children:"Cancelar"}),(0,n.jsx)(l.z,{type:"submit",disabled:f,children:f?(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(x.Z,{className:"animate-spin mr-2"})," ","Guardando..."]}):"Guardar"})]})]})})}},22782:function(e,a,r){"use strict";r.d(a,{I:function(){return i}});var n=r(57437),t=r(2265),s=r(22169);let i=t.forwardRef((e,a)=>{let{className:r,type:t,...i}=e;return(0,n.jsx)("input",{type:t,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:a,...i})});i.displayName="Input"},31162:function(e,a,r){"use strict";Object.defineProperty(a,"$",{enumerable:!0,get:function(){return t}});let n=r(15355);function t(e){let{createServerReference:a}=r(6671);return a(e,n.callServer)}},24033:function(e,a,r){e.exports=r(15313)}},function(e){e.O(0,[451,873,743,317,971,938,744],function(){return e(e.s=27338)}),_N_E=e.O()}]);