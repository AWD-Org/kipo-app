(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[319],{73067:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(62898).Z)("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]])},28203:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(62898).Z)("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]])},86264:function(e,t,r){"use strict";r.d(t,{Z:function(){return a}});/**
 * @license lucide-react v0.300.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */let a=(0,r(62898).Z)("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},66887:function(e,t,r){Promise.resolve().then(r.bind(r,96078)),Promise.resolve().then(r.bind(r,72358))},96078:function(e,t,r){"use strict";r.r(t),r.d(t,{default:function(){return g}});var a=r(57437),s=r(2265),i=r(24033),n=r(575),l=r(22782),o=r(73067),d=r(28203),c=r(86264);r(15355);var u=r(31162);(0,u.$)("57a426485a6b06027db8441044f1594d3c086f2b");var m=(0,u.$)("fa7c494de1d4863ac83ab020f061dc4df0b3dc98"),f=r(82749),x=r(22169);let p=["ahorro","inversi\xf3n","deuda","compra","otro"],b=["baja","media","alta"],h=[{value:"none",label:"Sin recordatorios"},{value:"daily",label:"Diario"},{value:"weekly",label:"Semanal"},{value:"monthly",label:"Mensual"}];function g(){let e=(0,i.useRouter)(),{data:t}=(0,f.useSession)(),[r,u]=(0,s.useState)(!1),[g,v]=(0,s.useState)(""),[y,j]=(0,s.useState)(!1),[N,w]=(0,s.useState)({title:"",description:"",targetAmount:"",currentAmount:"0",startDate:new Date().toISOString().split("T")[0],targetDate:"",category:"ahorro",priority:"media",reminderFrequency:"none"}),k=e=>{let{name:t,value:r}=e.target;w({...N,[t]:r})},F=async r=>{r.preventDefault();try{var a;if(u(!0),v(""),j(!1),!(null==t?void 0:null===(a=t.user)||void 0===a?void 0:a.id)){v("Debes iniciar sesi\xf3n para realizar esta acci\xf3n");return}if(!N.title.trim()){v("El t\xedtulo de la meta es requerido");return}if(!N.targetAmount||0>=parseFloat(N.targetAmount)){v("El monto objetivo debe ser mayor a cero");return}if(0>parseFloat(N.currentAmount)){v("El monto actual no puede ser negativo");return}if(!N.targetDate){v("La fecha objetivo es requerida");return}let r=new Date;if(new Date(N.targetDate)<=r){v("La fecha objetivo debe ser en el futuro");return}let s=new FormData;Object.entries(N).forEach(e=>{let[t,r]=e;s.append(t,r.toString())});let i=await m(t.user.id,s);if(!i.success){if(i.validationErrors){let e=Object.values(i.validationErrors).flat();v(e.join(", "))}else v(i.error||"Error al crear la meta");return}j(!0),window.confirm("Meta creada con \xe9xito. \xbfDeseas crear otra?")?w({title:"",description:"",targetAmount:"",currentAmount:"0",startDate:new Date().toISOString().split("T")[0],targetDate:"",category:"ahorro",priority:"media",reminderFrequency:"none"}):e.push("/dashboard")}catch(e){console.error("Error en createGoal:",e),v("Error al procesar la meta")}finally{u(!1)}},D=(0,x.SB)(parseFloat(N.currentAmount)||0,parseFloat(N.targetAmount)||1);return(0,a.jsx)("div",{className:"kipo-form-container",children:(0,a.jsxs)("form",{onSubmit:F,className:"space-y-8",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsxs)(n.z,{type:"button",variant:"ghost",size:"sm",onClick:()=>e.back(),className:"gap-1",children:[(0,a.jsx)(o.Z,{size:16})," Volver"]}),(0,a.jsx)("h1",{className:"text-2xl font-bold",children:"Nueva meta financiera"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"title",className:"text-sm font-medium",children:"T\xedtulo de la meta"}),(0,a.jsx)(l.I,{id:"title",name:"title",placeholder:"Ej. Fondo de emergencia, Vacaciones, etc.",value:N.title,onChange:k,required:!0})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"description",className:"text-sm font-medium",children:"Descripci\xf3n (opcional)"}),(0,a.jsx)("textarea",{id:"description",name:"description",placeholder:"Descripci\xf3n detallada de tu meta",value:N.description,onChange:k,className:"flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50"})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"targetAmount",className:"text-sm font-medium",children:"Monto objetivo"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),(0,a.jsx)(l.I,{id:"targetAmount",name:"targetAmount",type:"number",placeholder:"0.00",value:N.targetAmount,onChange:k,className:"pl-8",step:"0.01",min:"0",required:!0})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"currentAmount",className:"text-sm font-medium",children:"Monto actual (si ya tienes ahorrado algo)"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-muted-foreground",children:"$"}),(0,a.jsx)(l.I,{id:"currentAmount",name:"currentAmount",type:"number",placeholder:"0.00",value:N.currentAmount,onChange:k,className:"pl-8",step:"0.01",min:"0"})]})]}),N.targetAmount&&parseFloat(N.targetAmount)>0&&(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,a.jsx)("span",{children:"Progreso actual"}),(0,a.jsxs)("span",{children:[Math.round(D),"%"]})]}),(0,a.jsx)("div",{className:"w-full bg-secondary rounded-full h-2.5",children:(0,a.jsx)("div",{className:"bg-primary h-2.5 rounded-full",style:{width:"".concat(D,"%")}})}),(0,a.jsxs)("div",{className:"flex justify-between text-sm text-muted-foreground",children:[(0,a.jsx)("span",{children:(0,x.xG)(parseFloat(N.currentAmount)||0)}),(0,a.jsx)("span",{children:(0,x.xG)(parseFloat(N.targetAmount)||0)})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"startDate",className:"text-sm font-medium",children:"Fecha de inicio"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(l.I,{id:"startDate",name:"startDate",type:"date",value:N.startDate,onChange:k,className:"pl-10",required:!0})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"targetDate",className:"text-sm font-medium",children:"Fecha objetivo"}),(0,a.jsxs)("div",{className:"relative",children:[(0,a.jsx)(d.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,a.jsx)(l.I,{id:"targetDate",name:"targetDate",type:"date",value:N.targetDate,onChange:k,className:"pl-10",required:!0})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"category",className:"text-sm font-medium",children:"Categor\xeda"}),(0,a.jsx)("select",{id:"category",name:"category",value:N.category,onChange:k,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",required:!0,children:p.map(e=>(0,a.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"priority",className:"text-sm font-medium",children:"Prioridad"}),(0,a.jsx)("select",{id:"priority",name:"priority",value:N.priority,onChange:k,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",required:!0,children:b.map(e=>(0,a.jsx)("option",{value:e,children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("label",{htmlFor:"reminderFrequency",className:"text-sm font-medium",children:"Recordatorios"}),(0,a.jsx)("select",{id:"reminderFrequency",name:"reminderFrequency",value:N.reminderFrequency,onChange:k,className:"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",children:h.map(e=>(0,a.jsx)("option",{value:e.value,children:e.label},e.value))}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:"Recibir\xe1s recordatorios para contribuir a esta meta seg\xfan la frecuencia seleccionada."})]}),g&&(0,a.jsx)("div",{className:"rounded-md bg-destructive/15 p-3 text-sm text-destructive",children:g}),y&&(0,a.jsx)("div",{className:"rounded-md bg-green-100 p-3 text-sm text-green-800",children:"Meta creada con \xe9xito."}),(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsx)(n.z,{type:"button",variant:"outline",onClick:()=>e.back(),children:"Cancelar"}),(0,a.jsx)(n.z,{type:"submit",disabled:r,children:r?(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)(c.Z,{className:"mr-2 h-4 w-4 animate-spin"}),"Guardando..."]}):"Guardar meta"})]})]})})}},22782:function(e,t,r){"use strict";r.d(t,{I:function(){return n}});var a=r(57437),s=r(2265),i=r(22169);let n=s.forwardRef((e,t)=>{let{className:r,type:s,...n}=e;return(0,a.jsx)("input",{type:s,className:(0,i.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",r),ref:t,...n})});n.displayName="Input"},31162:function(e,t,r){"use strict";Object.defineProperty(t,"$",{enumerable:!0,get:function(){return s}});let a=r(15355);function s(e){let{createServerReference:t}=r(6671);return t(e,a.callServer)}},24033:function(e,t,r){e.exports=r(15313)}},function(e){e.O(0,[451,873,743,317,971,938,744],function(){return e(e.s=66887)}),_N_E=e.O()}]);